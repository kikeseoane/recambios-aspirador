{{ define "main" }}
  <h1>{{ .Title }}</h1>
  <p class="muted">Cat√°logo de modelos con recambios compatibles (bater√≠as, filtros, cepillos y cargadores) y soluci√≥n de problemas.</p>

  {{ $db := site.Data.aspiradores }}
  {{ $brands := $db.brands }}

  {{ if not $brands }}
    <p class="muted">No hay marcas cargadas en data/aspiradores.yaml</p>
  {{ else }}
    <div class="grid cards">
      {{ range $bk, $b := $brands }}
        {{ $brandName := or $b.name $bk }}
        {{ $models := $b.models }}

        {{ if and $models (eq (printf "%T" $models) "[]interface {}") }}
          {{ range $m := $models }}
            {{ $slug := (or (index $m "slug") (index $m "canonical_slug") (index $m "id")) | urlize }}
            <a class="card" href="{{ (printf "/modelos/%s/" $slug) | relURL }}">
              <div class="card-icon blue">üßæ</div>

              <h3>{{ $brandName }} {{ index $m "model" }}</h3>

              <div class="badges">
                <span class="badge">{{ $brandName }}</span>
                {{ with (index $m "series") }}<span class="badge">Serie {{ . }}</span>{{ end }}
                {{ with (index $m "year_range") }}<span class="badge">{{ . }}</span>{{ end }}
              </div>

              <p class="muted" style="margin-top:8px;">Recambios compatibles + fallos comunes.</p>
            </a>
          {{ end }}
        {{ end }}
      {{ end }}
    </div>
  {{ end }}
{{ end }}
