{{ define "main" }}
  <div class="hero">
    <div class="hero-inner">
      <div class="hero-left">
        <h1>{{ .Title }}</h1>
        <p class="muted">Catálogo de modelos con recambios compatibles (baterías, filtros, cepillos y cargadores) y solución de problemas.</p>

        <div class="hero-links">
          <a class="chip" href="{{ "/marcas/" | relURL }}">Ver marcas</a>
          <a class="chip" href="{{ "/guias/compra/" | relURL }}">Cómo elegir recambio</a>
        </div>
      </div>

      <div class="hero-right">
        <img class="hero-img" src="{{ "/img/hero.svg" | relURL }}" alt="" aria-hidden="true">
      </div>
    </div>
  </div>

  {{ $db := site.Data.aspiradores }}
  {{ $brands := $db.brands }}

  {{ if not $brands }}
    <p class="muted">No hay marcas cargadas en data/aspiradores.yaml</p>
  {{ else }}
    <div class="grid cards">
      {{ range $bk, $b := $brands }}
        {{ $brandName := or $b.name $bk }}
        {{ $models := $b.models }}

        {{ if and $models (reflect.IsSlice $models) }}
          {{ range $m := $models }}
            {{ $slug := (or (index $m "slug") (index $m "canonical_slug") (index $m "id")) | urlize }}

            <a class="card card--with-icon" href="{{ (printf "/modelos/%s/" $slug) | relURL }}">
              {{ partial "card_icon.html" (dict "kind" "model") }}

              <div class="card-body">
                <h3>{{ $brandName }} {{ index $m "model" }}</h3>

                <div class="badges">
                  <span class="badge">{{ $brandName }}</span>
                  {{ with (index $m "series") }}<span class="badge">Serie {{ . }}</span>{{ end }}
                  {{ with (index $m "year_range") }}<span class="badge">{{ . }}</span>{{ end }}
                </div>

                <p class="muted" style="margin-top:10px;">Recambios compatibles + fallos comunes.</p>
              </div>
            </a>

          {{ end }}
        {{ end }}
      {{ end }}
    </div>
  {{ end }}
{{ end }}
