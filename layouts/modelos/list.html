{{ define "main" }}
  {{/* HERO con fondo real (usa tu CSS: .hero--bg) */}}
  <section class="hero hero--bg">
    <div class="hero__inner">
      <div class="hero__kicker">Catálogo</div>
      <h1>{{ .Title }}</h1>
      <p class="muted hero__copy">
        Catálogo de modelos con recambios compatibles (baterías, filtros, cepillos y cargadores) y solución de problemas.
      </p>

      <div class="hero__links">
        <a class="btn btn--ghost" href="{{ "/marcas/" | relURL }}">Ver marcas</a>
        <a class="btn btn--link" href="{{ "/guias/compra/" | relURL }}">Cómo elegir recambio →</a>
      </div>
    </div>
  </section>

  {{ $db := site.Data.aspiradores }}
  {{ $brands := $db.brands }}

  {{ if not $brands }}
    <p class="muted">No hay marcas cargadas en data/aspiradores.yaml</p>
  {{ else }}
    <div class="grid cards">
      {{ range $bk, $b := $brands }}
        {{ $brandName := or $b.name $bk }}
        {{ $models := $b.models }}

        {{ if and $models (reflect.IsSlice $models) }}
          {{ range $m := $models }}
            {{ $slug := (or (index $m "slug") (index $m "canonical_slug") (index $m "id")) | urlize }}

            {{/* Evitar "Dyson Dyson V8" si el model ya incluye la marca */}}
            {{ $modelName := (index $m "model") | default "" }}
            {{ $bnLower := lower $brandName }}
            {{ $mnLower := lower $modelName }}
            {{ $title := "" }}
            {{ if and $modelName (hasPrefix $mnLower $bnLower) }}
              {{ $title = $modelName }}
            {{ else }}
              {{ $title = printf "%s %s" $brandName $modelName }}
            {{ end }}

            <a class="card card--with-icon" href="{{ (printf "/modelos/%s/" $slug) | relURL }}">
              {{ partial "card_icon.html" (dict "kind" "model") }}

              <div class="card-body">
                <h3>{{ $title }}</h3>

                <div class="badges">
                  <span class="badge">{{ $brandName }}</span>
                  {{ with (index $m "series") }}<span class="badge">Serie {{ . }}</span>{{ end }}
                  {{ with (index $m "year_range") }}<span class="badge">{{ . }}</span>{{ end }}
                </div>

                <p class="muted" style="margin-top:10px;">Recambios compatibles + fallos comunes.</p>
              </div>
            </a>

          {{ end }}
        {{ end }}
      {{ end }}
    </div>
  {{ end }}
{{ end }}
