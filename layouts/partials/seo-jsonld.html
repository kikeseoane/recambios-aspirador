{{- /* layouts/partials/seo-jsonld.html */ -}}
{{- $isHome := .IsHome -}}
{{- $title := cond $isHome site.Title (printf "%s | %s" .Title site.Title) -}}
{{- $desc := .Params.description | default "Guías para elegir recambios compatibles de aspiradores (filtros, baterías, cepillos y accesorios) sin equivocarte de modelo." -}}
{{- $canon := .Permalink -}}

{{- /* 1) BreadcrumbList (no home) */ -}}
{{- if not $isHome -}}
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"BreadcrumbList",
  "itemListElement":[
    {
      "@type":"ListItem",
      "position":1,
      "name":"Inicio",
      "item":"{{ site.BaseURL }}"
    }
    {{- $pos := 2 -}}
    {{- with .Section -}}
    ,{
      "@type":"ListItem",
      "position":{{ $pos }},
      "name":"{{ . | title }}",
      "item":"{{ (printf "%s%s/" site.BaseURL .) }}"
    }
    {{- $pos = add $pos 1 -}}
    {{- end -}}
    ,{
      "@type":"ListItem",
      "position":{{ $pos }},
      "name":"{{ .Title }}",
      "item":"{{ $canon }}"
    }
  ]
}
</script>
{{- end -}}

{{- /* 2) Article/WebPage schema (todas las páginas menos home) */ -}}
{{- if not $isHome -}}
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"Article",
  "headline": {{ $title | jsonify }},
  "description": {{ $desc | jsonify }},
  "inLanguage":"es-ES",
  "mainEntityOfPage": {
    "@type":"WebPage",
    "@id":"{{ $canon }}"
  },
  "publisher": {
    "@type":"Organization",
    "name": {{ site.Title | jsonify }},
    "url": {{ site.BaseURL | jsonify }}
  },
  "dateModified": "{{ (or .Lastmod .Date).Format "2006-01-02" }}",
  "datePublished": "{{ (or .Date .Lastmod).Format "2006-01-02" }}",
  "url":"{{ $canon }}"
}
</script>
{{- end -}}
