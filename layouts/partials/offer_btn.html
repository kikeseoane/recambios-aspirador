{{/* partials/offer_btn.html
- Si hay URL (real o default) => botÃ³n
- Si no hay URL => badge
- Si needs_url => muestra etiqueta "pendiente" (opcional)
*/}}

{{ $sku := .sku | default "" }}
{{ $label := .label | default "Ver oferta" }}
{{ $class := .class | default "btn-buy" }}

{{ $offersDoc := site.Data.ofertas }}
{{ $offers := cond (and $offersDoc $offersDoc.offers) $offersDoc.offers (dict) }}

{{ $offer := cond (and $sku (isset $offers $sku)) (index $offers $sku) (dict) }}
{{ $url := (index $offer "url") | default "" }}
{{ $needs := (index $offer "needs_url") | default false }}

{{ if $url }}
  <a class="{{ $class }}" href="{{ $url }}" rel="nofollow sponsored" target="_blank">
    {{ $label }}
  </a>

  {{ if $needs }}
    <span class="badge" style="margin-left:8px;">pendiente</span>
  {{ end }}

{{ else if $sku }}
  <span class="badge">SKU: {{ $sku }}</span>
{{ else }}
  <span class="badge">En preparaciÃ³n</span>
{{ end }}
