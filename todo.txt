==== ESTRUCTURA DE DIRECTORIOS ====

.\content
.\data
.\layouts
.\static
.\tools
.\content\guias
.\content\marcas
.\content\modelos
.\content\marcas\bosch
.\content\marcas\cecotec
.\content\marcas\dreame
.\content\marcas\dyson
.\content\marcas\irobot
.\content\marcas\philips
.\content\marcas\roborock
.\content\marcas\rowenta
.\content\marcas\samsung
.\content\marcas\shark
.\content\marcas\xiaomi
.\content\modelos\dyson-v10
.\content\modelos\dyson-v11
.\content\modelos\dyson-v15-detect
.\content\modelos\dyson-v8
.\layouts\guia
.\layouts\guias
.\layouts\marcas
.\layouts\modelos
.\layouts\partials
.\layouts\_default
.\static\css

==== CONTENIDO DE ARCHIVOS ====

===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\.gitignore
===============================
/public/
/resources/
.hugo_build.lock
todo.txt
.vscode/
.DS_Store
Thumbs.db


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\config.toml
===============================
baseURL = "https://recambios-aspirador.com/"
languageCode = "es-es"
title = "Recambios de Aspirador"
enableRobotsTXT = true

[sitemap]
  changefreq = "weekly"
  filename = "sitemap.xml"
  priority = 0.5

[permalinks]
  modelos = "/modelos/:slug/"
  marcas = "/marcas/:slug/"
  guias  = "/guias/:slug/"

[outputs]
  home = ["HTML", "RSS", "SITEMAP"]
  section = ["HTML", "RSS"]
  taxonomy = ["HTML"]
  term = ["HTML"]

[outputFormats]
  [outputFormats.SITEMAP]
    mediaType = "application/xml"
    baseName = "sitemap"
    isPlainText = true
    rel = "sitemap"

[params]
  siteName = "recambios-aspirador.com"
  defaultDescription = "Guías y recambios compatibles por marca y modelo de aspirador. Baterías, filtros, cepillos y cargadores con enlaces verificados."


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\lee.bat
===============================
@echo off
powershell -NoProfile -ExecutionPolicy Bypass -File lee.ps1


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\lee.ps1
===============================
$root = Get-Location
$out  = Join-Path $root "todo.txt"

$sb = New-Object System.Text.StringBuilder

$null = $sb.AppendLine("==== ESTRUCTURA DE DIRECTORIOS ====")
$null = $sb.AppendLine("")

# Directorios (sin tree para evitar caracteres OEM)
Get-ChildItem -Recurse -Directory | ForEach-Object {
  $rel = $_.FullName.Replace($root.Path, ".")
  $null = $sb.AppendLine($rel)
}

$null = $sb.AppendLine("")
$null = $sb.AppendLine("==== CONTENIDO DE ARCHIVOS ====")

# Archivos + contenido
Get-ChildItem -Recurse -File | ForEach-Object {
  $null = $sb.AppendLine("")
  $null = $sb.AppendLine("===============================")
  $null = $sb.AppendLine(("ARCHIVO: " + $_.FullName))
  $null = $sb.AppendLine("===============================")

  try {
    $content = Get-Content -Raw -Encoding UTF8 $_.FullName -ErrorAction Stop
  } catch {
    $content = Get-Content -Raw -Encoding Default $_.FullName
  }

  $null = $sb.AppendLine($content)
}

# Escribir SIEMPRE en UTF-8 sin BOM
$utf8NoBom = New-Object System.Text.UTF8Encoding($false)
[System.IO.File]::WriteAllText($out, $sb.ToString(), $utf8NoBom)


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\procedimiento
===============================
# 1) editas data\aspiradores.yaml
# 2) generas stubs que falten
Flujo correcto a partir de ahora (YAML como única fuente)

Editas solo data/aspiradores.yaml

Regeneras stubs:

python tools\generar.py --force --clean-modelos


Commit + push:

git add data/aspiradores.yaml content tools/generar.py
git commit -m "Update: datos + regen stubs"
git push



===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\v-instrucciones para Chatgpt.txt
===============================
Actúa como arquitecto senior SEO + ingeniero de sistemas para Hugo (static site generator) especializado en webs de afiliados escalables.

CONTEXTO Y ESTADO ACTUAL

Estoy construyendo una web tipo enciclopedia de marcas y modelos de aspiradores y sus recambios compatibles, fallos comunes y guías.

La web está hecha con Hugo y el objetivo es escalar a miles de modelos sin escribir páginas manuales.

Mi enfoque es data-driven:

Toda la información vive en un único fichero de datos (YAML o CSV).

Un script generador (Python) crea los stubs mínimos en /content/ si faltan.

Hugo renderiza páginas automáticas con plantillas.

Se busca evitar duplicación de contenido y errores SEO.

Tengo problemas previos de indexación (Search Console):

URLs duplicadas

canónicas mal definidas

páginas no enlazadas correctamente

algunas páginas detectadas como duplicadas o redirigidas

OBJETIVO PRINCIPAL

Quiero orientar el proyecto al modelo de monetización SEO + afiliados:

Capturar búsquedas transaccionales del tipo: “batería dyson v11 compatible”, “filtro conga 3090”, “cargador rowenta x-force”.

Capturar búsquedas informacionales: “dyson v11 no carga”, “conga pierde potencia”, etc.

Monetizar con Amazon Afiliados + AliExpress Afiliados + Adsense.

TAREA

Quiero que me propongas una arquitectura completa (técnica + SEO) para que la web sea una máquina escalable y bien indexada, incluyendo:

Estructura de URLs definitiva (sin duplicados, limpia, escalable)

Qué tipos de páginas deben existir:

marca

modelo

recambio por modelo

problemas por modelo

guías generales

Qué campos exactos debe tener mi fichero YAML/CSV maestro para que todo sea automático.

Qué debe generar el script Python exactamente (qué stubs, qué front matter, qué slugs).

Cómo diseñar las plantillas Hugo para evitar contenido duplicado y a la vez permitir que cada página sea “única”.

Cómo implementar correctamente:

canonical URLs

sitemap.xml

robots.txt

schema.org (FAQ, Product, BreadcrumbList)

breadcrumbs

enlaces internos automáticos

Estrategia SEO de escalado:

cómo atacar long-tail keywords

cómo priorizar modelos/recambios

cómo generar contenido útil sin ser penalizado por thin content

Estrategia de monetización:

dónde poner enlaces de afiliado

qué tipo de tablas comparativas usar

cómo insertar shortcodes para afiliación sin ensuciar el markdown

Checklist de validación:

cómo revisar duplicados

cómo comprobar que Google indexa bien

cómo evitar páginas huérfanas

ESPECIFICACIONES

Quiero máxima sencillez: una fuente de verdad (YAML/CSV).

No quiero editar cientos de archivos manualmente.

Todo debe ser automatizable.

Quiero que el sistema permita añadir nuevos modelos simplemente añadiendo una línea al YAML/CSV.

Quiero un enfoque preparado para 10.000+ páginas.

FORMATO DE RESPUESTA

Quiero una respuesta estructurada en fases:

Fase 0 (decisiones críticas)

Fase 1 (estructura de datos)

Fase 2 (generación de contenido)

Fase 3 (plantillas Hugo)

Fase 4 (SEO técnico)

Fase 5 (monetización)

Fase 6 (escalado)

Incluye ejemplos concretos de:

YAML real

front matter real

URLs reales

snippets de Hugo templates (list.html / single.html / partials)

snippet de Python para generar stubs

ejemplos de schema JSON-LD

CRITERIO DE CALIDAD

La solución debe estar orientada a:

indexación masiva sin penalización

evitar duplicados

alto CTR

enlazado interno perfecto

escalabilidad extrema

facilidad de mantenimiento

VERIFICACIÓN FINAL

Al final de tu respuesta quiero:

un checklist final de implementación

errores típicos y cómo evitarlos

una recomendación de “qué hacer primero mañana”

 Datos actuales

Te acabo de pegar todo lo desarrollado hasta el momento



===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\_index.md
===============================
---
title: Inicio
slug: ''
draft: false
generated: true
type: home
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\guias\compra.md
===============================
---
title: Cómo elegir recambio
slug: compra
draft: false
generated: true
type: guia
guideKey: compra
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\guias\mantenimiento.md
===============================
---
title: Mantenimiento
slug: mantenimiento
draft: false
generated: true
type: guia
guideKey: mantenimiento
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\guias\seguridad.md
===============================
---
title: Seguridad
slug: seguridad
draft: false
generated: true
type: guia
guideKey: seguridad
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\guias\_index.md
===============================
---
title: Guías
slug: guias
draft: false
generated: true
type: guias
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\_index.md
===============================
---
title: Marcas
slug: marcas
draft: false
generated: true
type: marcas
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\bosch\_index.md
===============================
---
title: Bosch
slug: bosch
draft: false
generated: true
brandKey: bosch
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\cecotec\_index.md
===============================
---
title: Cecotec
slug: cecotec
draft: false
generated: true
brandKey: cecotec
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\dreame\_index.md
===============================
---
title: Dreame
slug: dreame
draft: false
generated: true
brandKey: dreame
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\dyson\_index.md
===============================
---
title: Dyson
slug: dyson
draft: false
generated: true
brandKey: dyson
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\irobot\_index.md
===============================
---
title: iRobot
slug: irobot
draft: false
generated: true
brandKey: irobot
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\philips\_index.md
===============================
---
title: Philips
slug: philips
draft: false
generated: true
brandKey: philips
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\roborock\_index.md
===============================
---
title: Roborock
slug: roborock
draft: false
generated: true
brandKey: roborock
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\rowenta\_index.md
===============================
---
title: Rowenta
slug: rowenta
draft: false
generated: true
brandKey: rowenta
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\samsung\_index.md
===============================
---
title: Samsung
slug: samsung
draft: false
generated: true
brandKey: samsung
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\shark\_index.md
===============================
---
title: Shark
slug: shark
draft: false
generated: true
brandKey: shark
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\marcas\xiaomi\_index.md
===============================
---
title: Xiaomi
slug: xiaomi
draft: false
generated: true
brandKey: xiaomi
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\modelos\_index.md
===============================
---
title: Modelos
slug: modelos
draft: false
generated: true
type: modelos
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\modelos\dyson-v10\index.md
===============================
---
title: Dyson Dyson V10
slug: dyson-v10
draft: false
generated: true
brandKey: dyson
modelSlug: dyson-v10
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\modelos\dyson-v11\index.md
===============================
---
title: Dyson Dyson V11
slug: dyson-v11
draft: false
generated: true
brandKey: dyson
modelSlug: dyson-v11
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\modelos\dyson-v15-detect\index.md
===============================
---
title: Dyson Dyson V15 Detect
slug: dyson-v15-detect
draft: false
generated: true
brandKey: dyson
modelSlug: dyson-v15-detect
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\content\modelos\dyson-v8\index.md
===============================
---
title: Dyson Dyson V8
slug: dyson-v8
draft: false
generated: true
brandKey: dyson
modelSlug: dyson-v8
---


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\data\aspiradores.yaml
===============================
globals:
  categorias_recambios:
    - key: bateria
      label: "Batería"
      icon: "battery"
      buy_intent: "compra"
    - key: filtro
      label: "Filtros"
      icon: "filter"
      buy_intent: "compra"
    - key: cepillo
      label: "Cepillos y rodillos"
      icon: "brush"
      buy_intent: "compra"
    - key: cargador
      label: "Cargadores y fuentes"
      icon: "plug"
      buy_intent: "compra"
    - key: accesorios
      label: "Accesorios"
      icon: "tools"
      buy_intent: "compra"
  guias_genericas:
    seguridad:
      - "Desconecta el aspirador antes de manipular filtros, rodillos o batería."
      - "No laves filtros no lavables: revisa el tipo (HEPA lavable vs. cartucho seco)."
      - "Evita usar baterías no compatibles con el modelo/serie: riesgo de sobrecalentamiento y fallos de carga."
      - "Si hay olor a quemado, chispas o cortes repetidos: detén el uso y revisa obstrucciones y cableado."
    mantenimiento:
      - "Limpia el depósito y conductos: la obstrucción es la causa nº1 de pérdida de succión."
      - "Lava y seca filtros lavables (24h): la humedad genera malos olores y reduce el caudal."
      - "Retira pelo/hilos del rodillo cada 1-2 semanas si hay mascotas o alfombras."
      - "Revisa juntas y sellos: una fuga de aire baja el rendimiento incluso con motor correcto."
    compra:
      - "Prioriza recambios con encaje y conectores equivalentes (voltaje nominal y tipo de anclaje)."
      - "En filtros, elige el grado adecuado: HEPA para alergias; estándar para uso general."
      - "En rodillos, elige según suelo: soft roller para duro; multisuperficie para mixto."
      - "Si tu aspirador es robot, compra packs (filtros + cepillos laterales) para abaratar mantenimiento."
brands:
  dyson:
    name: "Dyson"
    country_hint: "UK"
    notes_brand: "Gama premium de aspiradores sin cable con alta disponibilidad de recambios compatibles (baterías, filtros y rodillos)."
    models:
      - model: "Dyson V8"
        slug: "dyson-v8"
        series: "V-Series"
        year_range: "2016-2021"
        intro: "Dyson V8 es una referencia en aspiradores sin cable por su equilibrio entre potencia, autonomía y facilidad de mantenimiento. Es especialmente popular en hogares medianos y con suelos mixtos. Los recambios compatibles más demandados suelen ser batería, filtros y rodillos."
        seo:
          title: "Dyson V8: recambios compatibles, fallos comunes y mantenimiento"
          description: "Guía completa del Dyson V8: compatibilidad, síntomas típicos (succión, batería, cepillo) y recambios compatibles por categorías."
        specs:
          tipo: "aspirador escoba sin cable"
          voltaje_nominal: "21.6V"
          notas: "Batería extraíble; filtros lavables según versión; cabezal directo o fluffy según pack."
        compatibilidad:
          - "Recambios específicos para Dyson V8 (no compatibles directos con V10/V11 por voltaje y anclaje)."
          - "Filtros pre y post-motor con referencia V8; evita los de V6/V7 salvo equivalencia confirmada."
          - "Rodillos varían por cabezal: Direct Drive vs. Soft Roller."
          - "Cargador suele ser específico por conector Dyson V8."
        fallos:
          - symptom: "Pérdida de succión o se para a los pocos segundos"
            severidad: "media"
            causas:
              - "Filtro saturado o húmedo"
              - "Obstrucción en tubo/cabezal"
              - "Juntas con fuga de aire"
            checks:
              - "Retira y limpia depósito y ciclón"
              - "Comprueba paso de aire en tubo con una linterna"
              - "Lava filtro lavable y seca 24h antes de usar"
            fix_hint: "Empieza por filtro y obstrucciones; si persiste, revisa juntas y el encaje del depósito."
          - symptom: "Autonomía muy baja o no carga"
            severidad: "alta"
            causas:
              - "Batería degradada"
              - "Cargador defectuoso"
              - "Conectores sucios o flojos"
            checks:
              - "Prueba carga completa y mide si mantiene potencia en modo normal"
              - "Revisa LED del cargador y el puerto"
              - "Comprueba holgura del pack de batería"
            fix_hint: "Sustituye batería compatible 21.6V; si no carga, prueba cargador antes de culpar a la electrónica."
          - symptom: "El cepillo no gira"
            severidad: "media"
            causas:
              - "Pelo/hilos bloqueando el rodillo"
              - "Rodillo gastado o rodamientos dañados"
              - "Cabezal con fallo de motor/engranaje"
            checks:
              - "Retira el rodillo y limpia extremos"
              - "Verifica que el rodillo gira libre a mano"
              - "Prueba el cabezal en modo suelo duro/alfombra si aplica"
            fix_hint: "Limpia y, si hay holgura o ruido, cambia rodillo compatible del cabezal correcto."
        recambios:
          bateria:
            - sku: "dyson-v8-bateria-compat-216v"
              title: "Batería compatible 21.6V para Dyson V8"
              note: "Pack de reemplazo con mismo voltaje nominal y anclaje V8."
              intent: "compra"
            - sku: "dyson-v8-bateria-compat-alta-cap"
              title: "Batería compatible alta capacidad 21.6V para Dyson V8"
              note: "Más autonomía; verifica dimensiones y encaje."
              intent: "compra"
          filtro:
            - sku: "dyson-v8-filtro-hepa-postmotor"
              title: "Filtro post-motor tipo HEPA compatible para Dyson V8"
              intent: "compra"
            - sku: "dyson-v8-filtro-premotor-pack2"
              title: "Filtro pre-motor compatible pack 2 para Dyson V8"
              intent: "compra"
          cepillo:
            - sku: "dyson-v8-cepillo-rodillo-direct-drive"
              title: "Rodillo compatible para cabezal Direct Drive Dyson V8"
              intent: "compra"
            - sku: "dyson-v8-cepillo-rodillo-soft-fluffy"
              title: "Rodillo compatible tipo Soft/Fluffy para Dyson V8"
              intent: "compra"
          cargador:
            - sku: "dyson-v8-cargador-compat-eu"
              title: "Cargador compatible EU para Dyson V8"
              intent: "compra"
          accesorios:
            - sku: "dyson-v8-accesorios-kit-boquillas"
              title: "Kit boquillas compatible (rincones + tapicería) para Dyson V8"
              intent: "compra"

      - model: "Dyson V10"
        slug: "dyson-v10"
        series: "V-Series"
        year_range: "2018-2022"
        intro: "Dyson V10 mejora la capacidad del depósito y la potencia respecto a generaciones anteriores, manteniendo un formato manejable. Es un modelo muy extendido por su rendimiento en suelos mixtos y por la oferta de recambios compatibles. La batería y los filtros son las sustituciones más habituales."
        seo:
          title: "Dyson V10: recambios compatibles (batería, filtros, rodillos) y fallos típicos"
          description: "Todo sobre Dyson V10: compatibilidad, síntomas comunes (batería, succión, cepillo) y catálogo de recambios compatibles."
        specs:
          tipo: "aspirador escoba sin cable"
          voltaje_nominal: "25.2V"
          notas: "Voltaje distinto a V8; filtros y batería con anclaje V10; diferentes cabezales según pack."
        compatibilidad:
          - "Baterías V10 (25.2V) no son intercambiables con V8 (21.6V)."
          - "Filtros V10 suelen ser específicos por forma/rosca."
          - "Rodillos dependen del cabezal (multisuperficie o soft roller)."
          - "Cargador compatible debe coincidir con conector y potencia."
        fallos:
          - symptom: "Se apaga al activar modo turbo"
            severidad: "media"
            causas:
              - "Batería degradada (caída de voltaje bajo carga)"
              - "Filtro muy sucio"
              - "Obstrucción parcial"
            checks:
              - "Prueba en modo normal para comparar"
              - "Limpia filtro y seca correctamente"
              - "Revisa conductos y ciclón"
            fix_hint: "Si solo falla en turbo tras limpiar, es típico de batería degradada."
          - symptom: "Ruido agudo y baja succión"
            severidad: "media"
            causas:
              - "Fuga de aire en juntas"
              - "Depósito mal encajado"
              - "Filtro mal asentado"
            checks:
              - "Recoloca depósito y filtro"
              - "Inspecciona juntas por grietas"
              - "Comprueba que no hay piezas flojas"
            fix_hint: "Reasienta piezas; si hay desgaste, cambia juntas/accesorios del depósito o filtro."
        recambios:
          bateria:
            - sku: "dyson-v10-bateria-compat-252v"
              title: "Batería compatible 25.2V para Dyson V10"
              intent: "compra"
            - sku: "dyson-v10-bateria-compat-alta-cap"
              title: "Batería compatible alta capacidad 25.2V para Dyson V10"
              note: "Recomendable para viviendas grandes; verifica ventilación y encaje."
              intent: "compra"
          filtro:
            - sku: "dyson-v10-filtro-hepa-postmotor"
              title: "Filtro post-motor tipo HEPA compatible para Dyson V10"
              intent: "compra"
            - sku: "dyson-v10-filtro-premotor-pack2"
              title: "Filtro pre-motor compatible pack 2 para Dyson V10"
              intent: "compra"
          cepillo:
            - sku: "dyson-v10-cepillo-rodillo-multisuperficie"
              title: "Rodillo compatible multisuperficie para Dyson V10"
              intent: "compra"
            - sku: "dyson-v10-cepillo-rodillo-soft-fluffy"
              title: "Rodillo compatible tipo Soft/Fluffy para Dyson V10"
              intent: "compra"
          cargador:
            - sku: "dyson-v10-cargador-compat-eu"
              title: "Cargador compatible EU para Dyson V10"
              intent: "compra"
          accesorios:
            - sku: "dyson-v10-accesorios-kit-mascotas"
              title: "Kit accesorios compatible para pelo de mascotas (mini cepillo + boquilla) Dyson V10"
              intent: "compra"

      - model: "Dyson V11"
        slug: "dyson-v11"
        series: "V-Series"
        year_range: "2019-2023"
        intro: "Dyson V11 destaca por su control inteligente de potencia y rendimiento estable en alfombras y suelos duros. Es muy común en hogares con mascotas por su capacidad de aspiración y accesorios. Los recambios más frecuentes son filtros, rodillos y batería compatible."
        seo:
          title: "Dyson V11: recambios compatibles y solución de fallos (succión, batería, cepillo)"
          description: "Guía del Dyson V11: compatibilidad, mantenimiento y recambios (batería, filtros, rodillos, cargador y accesorios)."
        specs:
          tipo: "aspirador escoba sin cable"
          voltaje_nominal: "25.2V"
          notas: "Batería extraíble; control de potencia automático según cabezal; filtros V11 específicos."
        compatibilidad:
          - "Batería 25.2V con formato V11; evita equivalencias genéricas sin anclaje correcto."
          - "Filtros V11 suelen compartir familia, pero confirma forma/rosca."
          - "Rodillos dependen del cabezal High Torque / Soft Roller."
          - "Cargador debe ser compatible con el modelo y región."
        fallos:
          - symptom: "Mensaje de filtro/obstrucción aunque esté limpio"
            severidad: "baja"
            causas:
              - "Filtro húmedo"
              - "Sensor interpreta restricción por microobstrucción"
              - "Depósito o ciclón con residuo fino"
            checks:
              - "Seca filtro 24h"
              - "Limpia ciclón y conductos con cepillo suave"
              - "Revisa entrada del cabezal"
            fix_hint: "Una microobstrucción en el codo o cabezal suele disparar avisos; limpia a fondo y seca bien."
          - symptom: "Vibración o ruido en el cabezal"
            severidad: "media"
            causas:
              - "Rodillo desbalanceado por pelo"
              - "Rodamientos con desgaste"
              - "Eje con holgura"
            checks:
              - "Limpia extremos del rodillo"
              - "Comprueba giro libre"
              - "Inspecciona daños visibles"
            fix_hint: "Si persiste tras limpieza, cambia rodillo compatible del cabezal específico."
        recambios:
          bateria:
            - sku: "dyson-v11-bateria-compat-252v"
              title: "Batería compatible 25.2V para Dyson V11"
              intent: "compra"
            - sku: "dyson-v11-bateria-compat-alta-cap"
              title: "Batería compatible alta capacidad 25.2V para Dyson V11"
              intent: "compra"
          filtro:
            - sku: "dyson-v11-filtro-hepa-postmotor"
              title: "Filtro post-motor tipo HEPA compatible para Dyson V11"
              intent: "compra"
            - sku: "dyson-v11-filtro-premotor-pack2"
              title: "Filtro pre-motor compatible pack 2 para Dyson V11"
              intent: "compra"
          cepillo:
            - sku: "dyson-v11-cepillo-rodillo-high-torque"
              title: "Rodillo compatible para cabezal High Torque Dyson V11"
              intent: "compra"
            - sku: "dyson-v11-cepillo-rodillo-soft-fluffy"
              title: "Rodillo compatible tipo Soft/Fluffy para Dyson V11"
              intent: "compra"
          cargador:
            - sku: "dyson-v11-cargador-compat-eu"
              title: "Cargador compatible EU para Dyson V11"
              intent: "compra"
          accesorios:
            - sku: "dyson-v11-accesorios-soporte-pared"
              title: "Soporte de pared compatible para Dyson V11"
              intent: "compra"

      - model: "Dyson V15 Detect"
        slug: "dyson-v15-detect"
        series: "V-Series"
        year_range: "2021-actual"
        intro: "Dyson V15 Detect es un modelo de alta gama muy extendido por su potencia y medición inteligente de partículas. Funciona especialmente bien en hogares con alfombras y mascotas gracias a sus cabezales avanzados. Sus recambios compatibles más habituales son filtros, rodillos y baterías de reemplazo."
        seo:
          title: "Dyson V15 Detect: recambios compatibles y fallos frecuentes"
          description: "Compatibilidad y mantenimiento del Dyson V15 Detect: síntomas típicos, checks rápidos y recambios compatibles (batería, filtros, rodillos y cargador)."
        specs:
          tipo: "aspirador escoba sin cable"
          voltaje_nominal: "25.2V"
          notas: "Cabezal Laser Slim/Fluffy según versión; sensor de polvo; batería extraíble."
        compatibilidad:
          - "Baterías 25.2V con anclaje específico V15; evita equivalencias de V10/V11 sin confirmación."
          - "Filtros HEPA de alta eficiencia; confirma tipo exacto de carcasa."
          - "Rodillos dependen del cabezal: Fluffy/Laser o multisuperficie."
          - "Cargador compatible con el conector Dyson de la serie."
        fallos:
          - symptom: "Potencia irregular o lectura de polvo errática"
            severidad: "baja"
            causas:
              - "Filtro muy sucio"
              - "Conducto con polvo fino"
              - "Depósito mal sellado"
            checks:
              - "Limpia filtro y ciclón"
              - "Revisa juntas"
              - "Comprueba que el depósito cierra sin holguras"
            fix_hint: "Con polvo fino, una limpieza completa del ciclón mejora estabilidad y rendimiento."
          - symptom: "No enciende o se apaga al poco tiempo"
            severidad: "alta"
            causas:
              - "Batería degradada"
              - "Conector flojo"
              - "Protección térmica por obstrucción"
            checks:
              - "Prueba sin tubo/cabezal para aislar el problema"
              - "Comprueba obstrucciones"
              - "Revisa encaje de batería"
            fix_hint: "Si se apaga incluso sin accesorios tras carga completa, la batería suele ser el origen."
        recambios:
          bateria:
            - sku: "dyson-v15-detect-bateria-compat-252v"
              title: "Batería compatible 25.2V para Dyson V15 Detect"
              intent: "compra"
            - sku: "dyson-v15-detect-bateria-compat-alta-cap"
              title: "Batería compatible alta capacidad 25.2V para Dyson V15 Detect"
              intent: "compra"
          filtro:
            - sku: "dyson-v15-detect-filtro-hepa-postmotor"
              title: "Filtro HEPA post-motor compatible para Dyson V15 Detect"
              intent: "compra"
            - sku: "dyson-v15-detect-filtro-premotor-pack2"
              title: "Filtro pre-motor compatible pack 2 para Dyson V15 Detect"
              intent: "compra"
          cepillo:
            - sku: "dyson-v15-detect-cepillo-rodillo-fluffy-laser"
              title: "Rodillo compatible tipo Fluffy/Laser para Dyson V15 Detect"
              intent: "compra"
            - sku: "dyson-v15-detect-cepillo-rodillo-multisuperficie"
              title: "Rodillo compatible multisuperficie para Dyson V15 Detect"
              intent: "compra"
          cargador:
            - sku: "dyson-v15-detect-cargador-compat-eu"
              title: "Cargador compatible EU para Dyson V15 Detect"
              intent: "compra"
          accesorios:
            - sku: "dyson-v15-detect-accesorios-kit-rincones"
              title: "Kit boquillas compatible (rincones + polvo) para Dyson V15 Detect"
              intent: "compra"


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\data\ofertas.yaml
===============================
offers:
  dyson-v10-accesorios-kit-mascotas:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v10-bateria-compat-252v:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v10-bateria-compat-alta-cap:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v10-cargador-compat-eu:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v10-cepillo-rodillo-multisuperficie:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v10-cepillo-rodillo-soft-fluffy:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v10-filtro-hepa-postmotor:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v10-filtro-premotor-pack2:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v11-accesorios-soporte-pared:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v11-bateria-compat-252v:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v11-bateria-compat-alta-cap:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v11-cargador-compat-eu:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v11-cepillo-rodillo-high-torque:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v11-cepillo-rodillo-soft-fluffy:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v11-filtro-hepa-postmotor:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v11-filtro-premotor-pack2:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v15-detect-accesorios-kit-rincones:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v15-detect-bateria-compat-252v:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v15-detect-bateria-compat-alta-cap:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v15-detect-cargador-compat-eu:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v15-detect-cepillo-rodillo-fluffy-laser:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v15-detect-cepillo-rodillo-multisuperficie:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v15-detect-filtro-hepa-postmotor:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v15-detect-filtro-premotor-pack2:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v8-accesorios-kit-boquillas:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v8-bateria-compat-216v:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v8-bateria-compat-alta-cap:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v8-cargador-compat-eu:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v8-cepillo-rodillo-direct-drive:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v8-cepillo-rodillo-soft-fluffy:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v8-filtro-hepa-postmotor:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES
  dyson-v8-filtro-premotor-pack2:
    url: RELLENAR_URL_ALIEXPRESS
    estimated_price_range: RELLENAR_COSTE_ESTIMADO
    badges:
    - RELLENAR_BADGES


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\index.html
===============================
{{ define "main" }}
  <h1>Recambios y guías por modelo</h1>
  <p class="muted">{{ site.Params.defaultDescription }}</p>

  {{ $db := site.Data.aspiradores }}
  {{ $brands := $db.brands }}

  <div class="section-head">
    <h2>Marcas</h2>
    <span class="chip">{{ len $brands }} marcas</span>
  </div>

  <div class="grid cards">
    {{ range $k, $b := $brands }}
      {{ $slug := $k | urlize }}
      <a class="card" href="{{ (printf "/marcas/%s/" $slug) | relURL }}">
        <h3>{{ $b.name }}</h3>
        <p class="muted">Ver modelos, fallos comunes y recambios compatibles.</p>
        <div class="badges">
          <span class="badge hot">{{ len $b.models }} modelos</span>
          {{ with $b.country_hint }}<span class="badge">{{ . }}</span>{{ end }}
        </div>
      </a>
    {{ end }}
  </div>

  <div class="section-head" style="margin-top:18px;">
    <h2>Guías rápidas</h2>
    <span class="chip">Checklists reutilizables</span>
  </div>

  <div class="grid cards">
    <a class="card" href="{{ "/guias/seguridad/" | relURL }}">
      <h3>Seguridad</h3>
      <p class="muted">Antes de manipular o desmontar.</p>
      <div class="badges"><span class="badge blue">Guía</span></div>
    </a>
    <a class="card" href="{{ "/guias/mantenimiento/" | relURL }}">
      <h3>Mantenimiento</h3>
      <p class="muted">Lo que más evita fallos.</p>
      <div class="badges"><span class="badge blue">Guía</span></div>
    </a>
    <a class="card" href="{{ "/guias/compra/" | relURL }}">
      <h3>Elegir recambio</h3>
      <p class="muted">Compatibilidad y criterios.</p>
      <div class="badges"><span class="badge blue">Guía</span></div>
    </a>
  </div>
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\guia\list.html
===============================
{{ define "main" }}
  <h1>{{ .Title }}</h1>
  <p class="muted">Guías genéricas reutilizadas para todos los modelos.</p>

  <div class="grid">
    {{ range .Pages }}
      <a class="card" href="{{ .RelPermalink }}">
        <h3>{{ .Title }}</h3>
        <span class="badge">Guía</span>
      </a>
    {{ end }}
  </div>
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\guia\single.html
===============================
{{ define "main" }}
  {{ $db := site.Data.aspiradores }}
  {{ $key := .Params.guideKey }}

  {{ $gg := $db.globals.guias_genericas }}
  {{ $g := "" }}

  {{ if and $gg $key }}
    {{ $t := printf "%T" $gg }}

    {{ if eq $t "map[string]interface {}" }}
      {{ $g = index $gg $key }}

    {{ else if eq $t "[]interface {}" }}
      {{ range $it := $gg }}
        {{ if and (eq (printf "%T" $it) "map[string]interface {}") (eq (index $it "key") $key) }}
          {{ $g = $it }}
        {{ end }}
      {{ end }}

    {{ end }}
  {{ end }}

  <h1>{{ .Title }}</h1>

  {{ if $g }}
    {{ $title := "" }}
    {{ if eq (printf "%T" $g) "map[string]interface {}" }}
      {{ $title = index $g "title" }}
    {{ end }}
    {{ with $title }}<h2>{{ . }}</h2>{{ end }}

    {{ $bullets := "" }}
    {{ if eq (printf "%T" $g) "map[string]interface {}" }}
      {{ $bullets = index $g "bullets" }}
    {{ end }}

    {{ if $bullets }}
      {{ if eq (printf "%T" $bullets) "[]interface {}" }}
        <ul class="list">
          {{ range $bullets }}<li>{{ . }}</li>{{ end }}
        </ul>
      {{ else }}
        <p class="muted">{{ $bullets }}</p>
      {{ end }}
    {{ else }}
      <p class="muted">Guía sin bullets (revisa YAML).</p>
    {{ end }}

    {{ $extra := "" }}
    {{ if eq (printf "%T" $g) "map[string]interface {}" }}
      {{ $extra = index $g "extra" }}
    {{ end }}
    {{ if and $extra (eq (printf "%T" $extra) "map[string]interface {}") }}
      {{ with (index $extra "aviso") }}
        <div class="card" style="margin-top:14px;">
          <strong>Aviso</strong>
          <p class="muted" style="margin:8px 0 0;">{{ . }}</p>
        </div>
      {{ end }}
    {{ end }}

  {{ else }}
    <p class="muted">No se encontró guideKey <strong>{{ $key }}</strong> en data/aspiradores.yaml</p>
  {{ end }}
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\guias\list.html
===============================
{{ define "main" }}
  <h1>{{ .Title }}</h1>
  <p class="muted">Guías genéricas reutilizadas para todos los modelos.</p>

  <div class="grid">
    {{ range .Pages }}
      <a class="card" href="{{ .RelPermalink }}">
        <h3>{{ .Title }}</h3>
        <span class="badge">Guía</span>
      </a>
    {{ end }}
  </div>
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\guias\single.html
===============================
{{ define "main" }}
  {{ $db := site.Data.aspiradores }}
  {{ $key := .Params.guideKey }}
  {{ $g := index $db.globals.guias_genericas $key }}

  <h1>{{ .Title }}</h1>
  {{ if $g }}
    <h2>{{ $g.title }}</h2>
    <ul class="list">
      {{ range $g.bullets }}<li>{{ . }}</li>{{ end }}
    </ul>
  {{ else }}
    <p class="muted">No se encontró guideKey en YAML.</p>
  {{ end }}
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\marcas\list.html
===============================
{{ define "main" }}
  {{ $db := site.Data.aspiradores }}
  {{ $brands := $db.brands }}
  {{ $brandKey := .Params.brandKey }}

  {{ if $brandKey }}
    {{ $brand := index $brands $brandKey }}

    {{ if $brand }}
      <h1>{{ $brand.name }}</h1>
      <p class="muted">Elige tu modelo para ver recambios compatibles, checks y fallos comunes.</p>

      {{ $models := $brand.models }}
      {{ if $models }}
        <div class="grid cards">
          {{ range $m := $models }}
            {{ $mslug := (or $m.slug $m.canonical_slug) | urlize }}
            <a class="card" href="{{ (printf "/modelos/%s/" $mslug) | relURL }}">
              <h3>{{ $brand.name }} {{ $m.model }}</h3>
              <div class="badges">
                {{ with $m.series }}<span class="badge">Serie {{ . }}</span>{{ end }}
                {{ with $m.year_range }}<span class="badge">{{ . }}</span>{{ end }}
              </div>
              <p class="muted" style="margin-top:8px;">Ver recambios y guía rápida de compatibilidad.</p>
            </a>
          {{ end }}
        </div>
      {{ else }}
        <div class="card">
          <h3>Modelos en preparación</h3>
          <p class="muted">Estamos ampliando esta marca. Vuelve en breve para ver modelos y recambios.</p>
        </div>
      {{ end }}

      <div style="margin-top:14px;" class="chips">
        <a class="chip" href="{{ "/marcas/" | relURL }}">← Volver a marcas</a>
        <a class="chip" href="{{ "/modelos/" | relURL }}">Ver todos los modelos</a>
      </div>
    {{ else }}
      <h1>Marca no disponible</h1>
      <p class="muted">No encontramos esa marca en el catálogo actual.</p>
      <div style="margin-top:14px;" class="chips">
        <a class="chip" href="{{ "/marcas/" | relURL }}">Volver a marcas</a>
      </div>
    {{ end }}

  {{ else }}
    <h1>{{ .Title }}</h1>
    <p class="muted">Elige una marca para ver sus modelos y recambios compatibles.</p>

    <div class="grid cards">
      {{ range $k, $b := $brands }}
        {{ $slug := $k | urlize }}
        <a class="card" href="{{ (printf "/marcas/%s/" $slug) | relURL }}">
          <h3>{{ $b.name }}</h3>
          <p class="muted">Ver modelos, fallos comunes y recambios compatibles.</p>
          <div class="badges">
            <span class="badge hot">{{ len $b.models }} modelos</span>
            {{ with $b.country_hint }}<span class="badge">{{ . }}</span>{{ end }}
          </div>
        </a>
      {{ end }}
    </div>
  {{ end }}
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\marcas\single.html
===============================
{{ define "main" }}
  {{ $db := site.Data.aspiradores }}
  {{ $brandKey := .Params.brandKey }}
  {{ $brand := index $db.brands $brandKey }}

  <h1>{{ $brand.name }}</h1>
  <p class="muted">Modelos disponibles con recambios y fallos comunes.</p>

  <div class="grid">
    {{ range $m := $brand.models }}
      <a class="card" href="{{ (printf "/modelos/%s/" $m.slug) | relURL }}">
        <h3>{{ $brand.name }} {{ $m.model }}</h3>
        {{ with $m.series }}<span class="badge">Serie {{ . }}</span>{{ end }}
      </a>
    {{ end }}
  </div>
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\modelos\list.html
===============================
{{ define "main" }}
  <h1>{{ .Title }}</h1>
  <p class="muted">Listado global de modelos (viene de YAML).</p>

  {{ $db := site.Data.aspiradores }}
  {{ $brands := $db.brands }}

  {{ if not $brands }}
    <p class="muted">No hay marcas cargadas en data/aspiradores.yaml</p>
  {{ else }}
    <div class="grid cards">
      {{ range $bk, $b := $brands }}
        {{ $brandName := or $b.name $bk }}
        {{ $models := $b.models }}

        {{ if and $models (eq (printf "%T" $models) "[]interface {}") }}
          {{ range $m := $models }}
            {{ $slug := (or (index $m "slug") (index $m "canonical_slug") (index $m "id")) | urlize }}
            <a class="card" href="{{ (printf "/modelos/%s/" $slug) | relURL }}">
              <h3>{{ $brandName }} {{ index $m "model" }}</h3>
              <div class="badges">
                <span class="badge">{{ $brandName }}</span>
                {{ with (index $m "series") }}<span class="badge">Serie {{ . }}</span>{{ end }}
                {{ with (index $m "year_range") }}<span class="badge">{{ . }}</span>{{ end }}
              </div>
              <p class="muted" style="margin-top:8px;">Recambios compatibles + fallos comunes.</p>
            </a>
          {{ end }}
        {{ end }}
      {{ end }}
    </div>
  {{ end }}
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\modelos\single.html
===============================
{{ define "main" }}
  {{ $db := site.Data.aspiradores }}
  {{ $brands := $db.brands }}

  {{ $brandKey := .Params.brandKey }}
  {{ $modelSlug := (or .Params.modelSlug .Params.slug) | urlize }}

  {{ $brand := index $brands $brandKey }}

  {{ if not $brand }}
    <h1>Modelo no disponible</h1>
    <p class="muted">No encontramos la marca asociada a este modelo.</p>
    <div class="chips" style="margin-top:14px;">
      <a class="chip" href="{{ "/marcas/" | relURL }}">Ver marcas</a>
      <a class="chip" href="{{ "/modelos/" | relURL }}">Ver todos los modelos</a>
    </div>

  {{ else }}

    {{/* Buscar modelo en YAML */}}
    {{ $model := dict }}
    {{ $models := $brand.models }}

    {{ if and $models (eq (printf "%T" $models) "[]interface {}") }}
      {{ range $m := $models }}
        {{ $mid := (or (index $m "slug") (index $m "canonical_slug") (index $m "id")) | urlize }}
        {{ if eq $mid $modelSlug }}
          {{ $model = $m }}
        {{ end }}
      {{ end }}
    {{ end }}

    {{ if not (len $model) }}
      <div class="breadcrumbs">
        <a href="{{ "/" | relURL }}">Inicio</a><span class="sep">›</span>
        <a href="{{ "/marcas/" | relURL }}">Marcas</a><span class="sep">›</span>
        <a href="{{ (printf "/marcas/%s/" ($brandKey | urlize)) | relURL }}">{{ $brand.name }}</a>
      </div>

      <h1>{{ .Title }}</h1>
      <p class="muted">Estamos terminando de preparar la ficha de este modelo.</p>

      <div class="card" style="margin-top:14px;">
        <h3>Mientras tanto</h3>
        <p class="muted">Puedes volver a la marca y elegir otro modelo disponible.</p>
        <div class="chips" style="margin-top:10px;">
          <a class="chip" href="{{ (printf "/marcas/%s/" ($brandKey | urlize)) | relURL }}">Ver modelos {{ $brand.name }}</a>
          <a class="chip" href="{{ "/modelos/" | relURL }}">Todos los modelos</a>
        </div>
      </div>

    {{ else }}

      <div class="breadcrumbs">
        <a href="{{ "/" | relURL }}">Inicio</a><span class="sep">›</span>
        <a href="{{ "/marcas/" | relURL }}">Marcas</a><span class="sep">›</span>
        <a href="{{ (printf "/marcas/%s/" ($brandKey | urlize)) | relURL }}">{{ $brand.name }}</a><span class="sep">›</span>
        <span>{{ $brand.name }} {{ index $model "model" }}</span>
      </div>

      <div class="hero" style="margin-top:10px;">
        <div class="kicker">Modelo</div>
        <h1>{{ $brand.name }} {{ index $model "model" }}</h1>
        {{ with (index $model "intro") }}<p class="muted">{{ . }}</p>{{ end }}

        <div class="chips">
          {{ with (index $model "series") }}<span class="chip active">Serie {{ . }}</span>{{ end }}
          {{ with (index $model "year_range") }}<span class="chip">{{ . }}</span>{{ end }}
          <a class="chip" href="{{ "/guias/compra/" | relURL }}">Cómo elegir recambio</a>
          <a class="chip" href="{{ "/guias/mantenimiento/" | relURL }}">Mantenimiento</a>
          <a class="chip" href="{{ "/guias/seguridad/" | relURL }}">Seguridad</a>
        </div>
      </div>

      <div class="two-col" style="margin-top:12px;">
        <div class="panel">
          <h2 style="margin-top:0;">Compatibilidad rápida</h2>

          {{ $compat := index $model "compatibilidad" }}
          {{ if $compat }}
            {{ if eq (printf "%T" $compat) "[]interface {}" }}
              <ul class="list">
                {{ range $compat }}<li>{{ . }}</li>{{ end }}
              </ul>
            {{ else }}
              <p class="muted">{{ $compat }}</p>
            {{ end }}
          {{ else }}
            <p class="muted">Consejo: confirma variante exacta (Animal/Absolute/etc.) y compara encajes en el anuncio.</p>
          {{ end }}

          <hr>

          <h2 style="margin-top:0;">Recambios compatibles</h2>
          <p class="muted small">Enlaces a AliExpress (externo). Verifica compatibilidad exacta antes de comprar.</p>

          {{ $cats := $db.globals.categorias_recambios }}
          {{ $rec := index $model "recambios" }}

          {{ if and $cats (eq (printf "%T" $cats) "[]interface {}") (and $rec (eq (printf "%T" $rec) "map[string]interface {}")) }}
            {{ range $cat := $cats }}
              {{ $catKey := index $cat "key" }}
              {{ $catLabel := index $cat "label" }}
              {{ $catIcon := index $cat "icon" }}

              {{ $items := index $rec $catKey }}
              {{ if $items }}
                <h2 style="margin-bottom:8px;">{{ $catLabel }}</h2>

                <div class="products">
                  {{ if eq (printf "%T" $items) "[]interface {}" }}
                    {{ range $it := $items }}
                      <div class="product">
                        <div class="img">{{ $catIcon | default "🧩" }}</div>

                        <div class="body">
                          <div class="title">{{ index $it "title" }}</div>

                          {{ with (index $it "note") }}
                            <div class="note muted" style="margin-top:10px;">{{ . }}</div>
                          {{ end }}

                          <div class="cta">
                            {{/* Migración SKU: si existe sku lo mostramos; si existe url, link */}}
                            {{ if (index $it "url") }}
                              <a class="btn-buy" href="{{ index $it "url" }}" rel="nofollow sponsored" target="_blank">Ver en AliExpress</a>
                            {{ else if (index $it "sku") }}
                              <span class="badge">SKU: {{ index $it "sku" }}</span>
                            {{ else }}
                              <span class="badge">En preparación</span>
                            {{ end }}
                          </div>
                        </div>
                      </div>
                    {{ end }}
                  {{ else }}
                    <div class="card">
                      <p class="muted">Recambios mal formateados en YAML (esperaba lista).</p>
                    </div>
                  {{ end }}
                </div>
              {{ end }}
            {{ end }}
          {{ end }}

          <hr>

          <h2 style="margin-top:0;">Fallos comunes y checks</h2>

          {{ $fallos := index $model "fallos" }}
          {{ if $fallos }}
            {{ if eq (printf "%T" $fallos) "[]interface {}" }}
              <div class="grid cols-2">
                {{ range $f := $fallos }}
                  <div class="panel">
                    <div class="badge warn">Síntoma</div>
                    <h3 style="margin:10px 0 8px;">{{ index $f "symptom" }}</h3>

                    {{ $causas := index $f "causas" }}
                    {{ if $causas }}
                      <div class="kicker">Causas probables</div>
                      {{ if eq (printf "%T" $causas) "[]interface {}" }}
                        <ul>
                          {{ range $causas }}<li>{{ . }}</li>{{ end }}
                        </ul>
                      {{ else }}
                        <p class="muted">{{ $causas }}</p>
                      {{ end }}
                    {{ end }}

                    {{ $checks := index $f "checks" }}
                    {{ if $checks }}
                      <div class="kicker">Cómo comprobar</div>
                      {{ if eq (printf "%T" $checks) "[]interface {}" }}
                        <ul>
                          {{ range $checks }}<li>{{ . }}</li>{{ end }}
                        </ul>
                      {{ else }}
                        <p class="muted">{{ $checks }}</p>
                      {{ end }}
                    {{ end }}

                    {{ with (index $f "fix_hint") }}
                      <p class="muted small" style="margin-top:10px;">{{ . }}</p>
                    {{ end }}
                  </div>
                {{ end }}
              </div>
            {{ else }}
              <p class="muted">{{ $fallos }}</p>
            {{ end }}
          {{ else }}
            <p class="muted">Aquí iremos añadiendo los fallos más típicos y las comprobaciones rápidas.</p>
          {{ end }}
        </div>

        <aside class="panel">
          <h2 style="margin-top:0;">Antes de comprar</h2>
          <p class="muted small">Checklist rápida para evitar incompatibilidades.</p>

          {{ $gg := $db.globals.guias_genericas }}
          {{ $compra := "" }}
          {{ $compraObj := "" }}

          {{ if $gg }}
            {{ $t := printf "%T" $gg }}

            {{ if eq $t "map[string]interface {}" }}
              {{ $compra = index $gg "compra" }}

            {{ else if eq $t "[]interface {}" }}
              {{ range $it := $gg }}
                {{ if and (eq (printf "%T" $it) "map[string]interface {}") (eq (index $it "key") "compra") }}
                  {{ $compra = $it }}
                {{ end }}
              {{ end }}
            {{ end }}
          {{ end }}

          {{/* Normaliza: compraObj debe ser map, no slice */}}
          {{ if $compra }}
            {{ $ct := printf "%T" $compra }}
            {{ if eq $ct "map[string]interface {}" }}
              {{ $compraObj = $compra }}
            {{ else if eq $ct "[]interface {}" }}
              {{ if gt (len $compra) 0 }}
                {{ $first := index $compra 0 }}
                {{ if eq (printf "%T" $first) "map[string]interface {}" }}
                  {{ $compraObj = $first }}
                {{ end }}
              {{ end }}
            {{ end }}
          {{ end }}

          <div class="panel" style="box-shadow:none;background:#fff;border-style:dashed;">
            {{ if $compraObj }}
              {{ with (index $compraObj "title") }}<div class="kicker">{{ . }}</div>{{ end }}

              {{ $bullets := index $compraObj "bullets" }}
              {{ if $bullets }}
                {{ if eq (printf "%T" $bullets) "[]interface {}" }}
                  <ul class="small">
                    {{ range $bullets }}<li>{{ . }}</li>{{ end }}
                  </ul>
                {{ else }}
                  <p class="muted small">{{ $bullets }}</p>
                {{ end }}
              {{ end }}
            {{ else }}
              <div class="kicker">Cómo elegir recambio compatible</div>
              <p class="muted small">Revisa modelo exacto, encajes y política de devolución.</p>
            {{ end }}
          </div>

          <div style="margin-top:12px;">
            <div class="kicker">Atajos</div>
            <div class="chips">
              <a class="chip" href="{{ "/marcas/" | relURL }}">Más marcas</a>
              <a class="chip" href="{{ (printf "/marcas/%s/" ($brandKey | urlize)) | relURL }}">Más modelos {{ $brand.name }}</a>
              <a class="chip" href="{{ "/modelos/" | relURL }}">Todos los modelos</a>
            </div>
          </div>

          <hr>

          <div class="kicker">Transparencia</div>
          <p class="muted small">Algunos enlaces pueden ser de afiliación. Precio y disponibilidad dependen del vendedor.</p>
        </aside>
      </div>

    {{ end }}
  {{ end }}
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\partials\footer.html
===============================
<footer class="site-footer">
  <div class="container">
    <p class="muted">© {{ now.Format "2006" }} {{ site.Title }} · Información orientativa. Verifica compatibilidad antes de comprar.</p>
  </div>
</footer>


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\partials\get_guia.html
===============================
{{/* 
partials/get_guia.html
Uso:
  {{ $g := partial "get_guia.html" (dict "db" site.Data.aspiradores "key" "compra") }}
Devuelve:
  dict con campos (title, bullets, etc.) o dict vacío si no existe
Soporta:
  globals.guias_genericas como MAP o como LISTA (con campo key)
*/}}

{{ $db := .db }}
{{ $key := .key }}

{{ $out := dict }}

{{ if and $db $db.globals $db.globals.guias_genericas }}
  {{ $gg := $db.globals.guias_genericas }}

  {{/* Caso 1: MAP */}}
  {{ if reflect.IsMap $gg }}
    {{ $cand := index $gg $key }}
    {{ if $cand }}
      {{ $out = $cand }}
    {{ end }}
  {{ end }}

  {{/* Caso 2: LISTA */}}
  {{ if and (not (len $out)) (reflect.IsSlice $gg) }}
    {{ range $it := $gg }}
      {{ if and $it (eq ($it.key | default "") $key) }}
        {{ $out = $it }}
      {{ end }}
    {{ end }}
  {{ end }}
{{ end }}

{{ return $out }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\partials\header.html
===============================
<header class="site-header">
  <div class="container header-inner">
    <a class="brand" href="{{ "/" | relURL }}">
      {{ site.Title }}
      <span class="brand-badge">Marketplace</span>
    </a>

    <form class="searchbar" action="{{ "/modelos/" | relURL }}" method="get">
      <input name="q" placeholder="Busca tu modelo (ej: Dyson V10, Conga 4090)"/>
      <button type="submit">Buscar</button>
    </form>

    <nav class="nav">
      <a href="{{ "/marcas/" | relURL }}">Marcas</a>
      <a href="{{ "/modelos/" | relURL }}">Modelos</a>
      <a href="{{ "/guias/" | relURL }}">Guías</a>
    </nav>
  </div>
</header>



===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\_default\baseof.html
===============================
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{{ if .Title }}{{ .Title }} | {{ end }}{{ site.Title }}</title>

  {{ $desc := .Params.description | default site.Params.defaultDescription }}
  <meta name="description" content="{{ $desc }}">

  <link rel="canonical" href="{{ .Permalink }}">
  <link rel="stylesheet" href="{{ "css/site.css" | relURL }}">
  {{ hugo.Generator }}
</head>
<body>
  {{ partial "header.html" . }}
  <main class="container">
    {{ block "main" . }}{{ end }}
  </main>
  {{ partial "footer.html" . }}
</body>
</html>


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\_default\list.html
===============================
{{ define "main" }}
  <h1>{{ .Title }}</h1>

  {{ if .Pages }}
    <div class="grid">
      {{ range .Pages }}
        <a class="card" href="{{ .RelPermalink }}">
          <h3>{{ .Title }}</h3>
          <span class="badge">{{ .Section }}</span>
        </a>
      {{ end }}
    </div>
  {{ else }}
    <p class="muted">No hay páginas aún.</p>
  {{ end }}
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\layouts\_default\single.html
===============================
{{ define "main" }}
  <h1>{{ .Title }}</h1>
  {{ if .Content }}
    {{ .Content }}
  {{ else }}
    <p class="muted">Página sin contenido.</p>
  {{ end }}
{{ end }}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\static\css\site.css
===============================
:root{
  --bg:#f5f5f5;
  --surface:#ffffff;
  --fg:#111827;
  --muted:#6b7280;

  --primary:#ff6a00;     /* naranja marketplace */
  --primary-2:#ff8a33;
  --accent:#2563eb;      /* azul links */
  --border:#e5e7eb;

  --shadow: 0 8px 24px rgba(17,24,39,.08);
  --radius:14px;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:var(--bg);
  color:var(--fg);
}
a{color:inherit;text-decoration:none}
a:hover{text-decoration:none}

.container{max-width:1100px;margin:0 auto;padding:18px}

.site-header{
  background:var(--surface);
  border-bottom:1px solid var(--border);
  position: sticky; top:0; z-index:10;
}
.header-inner{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:10px 0}
.brand{
  font-weight:800; letter-spacing:.2px;
  display:flex; align-items:center; gap:10px;
}
.brand-badge{
  font-size:12px; padding:4px 8px; border-radius:999px;
  background:rgba(255,106,0,.12);
  color:var(--primary);
  border:1px solid rgba(255,106,0,.25);
}

.nav{display:flex;align-items:center;gap:14px}
.nav a{color:var(--muted);font-weight:600}
.nav a:hover{color:var(--fg)}

.searchbar{
  display:flex; gap:10px; align-items:center;
  padding:10px; border-radius:999px;
  border:1px solid var(--border);
  background:#fff;
  box-shadow: 0 1px 0 rgba(0,0,0,.03);
}
.searchbar input{
  border:none; outline:none; width:320px; max-width:45vw;
  font-size:14px;
}
.searchbar button{
  border:none; cursor:pointer;
  background:linear-gradient(90deg,var(--primary),var(--primary-2));
  color:#fff; font-weight:800;
  padding:8px 12px; border-radius:999px;
}
.searchbar button:hover{filter:brightness(.98)}

h1{font-size:32px;margin:14px 0 8px}
h2{font-size:20px;margin:22px 0 10px}
p{line-height:1.55}
.muted{color:var(--muted)}

.section-head{
  display:flex; align-items:baseline; justify-content:space-between;
  gap:12px;
}
.section-head .chip{
  font-size:12px; color:var(--muted);
  background:rgba(17,24,39,.04);
  border:1px solid var(--border);
  padding:4px 10px; border-radius:999px;
}

/* grids */
.grid{display:grid;gap:14px;margin-top:12px}
.grid.cards{grid-template-columns: repeat(auto-fit,minmax(240px,1fr))}
.grid.products{grid-template-columns: repeat(auto-fit,minmax(260px,1fr))}

.card{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:14px;
  box-shadow: var(--shadow);
  transition: transform .12s ease, box-shadow .12s ease;
}
.card:hover{transform: translateY(-2px); box-shadow: 0 12px 28px rgba(17,24,39,.12)}
.card h3{margin:0 0 6px;font-size:16px}
.card p{margin:0}

.badges{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
.badge{
  display:inline-flex; align-items:center; gap:6px;
  font-size:12px; padding:4px 10px; border-radius:999px;
  border:1px solid var(--border);
  background:#fff;
  color:var(--muted);
}
.badge.hot{
  border-color:rgba(255,106,0,.35);
  background:rgba(255,106,0,.12);
  color:var(--primary);
}
.badge.blue{
  border-color:rgba(37,99,235,.25);
  background:rgba(37,99,235,.10);
  color:var(--accent);
}

hr{border:none;border-top:1px solid var(--border);margin:22px 0}

/* product card feel */
.prod-title{font-weight:800}
.price{
  display:flex;align-items:baseline;gap:8px;margin-top:10px
}
.price .now{font-size:20px;font-weight:900;color:var(--primary)}
.price .range{font-size:13px;color:var(--muted)}
.meta-row{display:flex;align-items:center;justify-content:space-between;margin-top:10px;color:var(--muted);font-size:13px}
.star{color: #f59e0b; font-weight:900}
.cta{
  margin-top:12px;
  display:flex; justify-content:space-between; align-items:center; gap:10px;
}
.cta a{
  display:inline-flex; align-items:center; justify-content:center;
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  background:linear-gradient(90deg,var(--primary),var(--primary-2));
  color:#fff; font-weight:900;
}
.cta a:hover{filter:brightness(.98)}
.small-link{color:var(--accent);font-weight:700}

.site-footer{
  margin-top:30px;
  padding:22px 0;
  border-top:1px solid var(--border);
  background:var(--surface);
}


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\tools\generar.py
===============================
from __future__ import annotations

import argparse
import re
from pathlib import Path

try:
    import yaml
except ImportError:
    raise SystemExit("Falta PyYAML. Instala con: pip install pyyaml")


ROOT = Path(__file__).resolve().parents[1]
DATA = ROOT / "data" / "aspiradores.yaml"
CONTENT = ROOT / "content"


def slugify(s: str) -> str:
    s = (s or "").strip().lower()
    s = re.sub(r"[^\w\s-]", "", s, flags=re.UNICODE)
    s = re.sub(r"[\s_-]+", "-", s)
    return s.strip("-")


def ensure_dir(p: Path) -> None:
    p.mkdir(parents=True, exist_ok=True)


def write_file(path: Path, content: str, force: bool = False) -> None:
    """Write content to path. If force=False, only write if missing."""
    if path.exists() and not force:
        return
    ensure_dir(path.parent)
    path.write_text(content, encoding="utf-8")


def fm(
    *,
    title: str,
    slug: str,
    kind: str | None = None,
    extra: dict | None = None,
    generated: bool = True,
) -> str:
    """
    Front matter YAML delimitado por ---.

    - kind: si None, NO se escribe 'type' (Hugo usará section por defecto).
    - extra: dict adicional a volcar en YAML.
    """
    data: dict = {
        "title": title,
        "slug": slug,
        "draft": False,
    }
    if generated:
        data["generated"] = True

    if kind:  # solo si lo queremos explícito
        data["type"] = kind

    if extra:
        data.update(extra)

    # YAML "bonito" y estable
    body = yaml.safe_dump(
        data,
        sort_keys=False,
        allow_unicode=True,
        default_flow_style=False,
    ).strip()

    return f"---\n{body}\n---\n"


def load_db() -> dict:
    if not DATA.exists():
        raise SystemExit(f"No existe {DATA}")
    return yaml.safe_load(DATA.read_text(encoding="utf-8")) or {}


# -------------------------------
# Limpiezas
# -------------------------------

def clean_modelos_dir() -> None:
    """
    Limpieza "bruta" (legacy):
    borra todo content/modelos excepto modelos/_index.md.
    """
    modelos = CONTENT / "modelos"
    if modelos.exists():
        for child in modelos.iterdir():
            if child.name == "_index.md":
                continue
            if child.is_dir():
                for p in sorted(child.rglob("*"), reverse=True):
                    if p.is_file():
                        p.unlink()
                    else:
                        p.rmdir()
                child.rmdir()
            elif child.is_file():
                child.unlink()


def is_generated_file(path: Path) -> bool:
    """
    Detecta si un .md fue generado por el sistema.
    Criterio: contiene 'generated: true' en el front matter.
    """
    if not path.exists() or not path.is_file():
        return False
    txt = path.read_text(encoding="utf-8", errors="ignore")
    return "generated: true" in txt.lower()


def safe_clean_section(section_dir: Path) -> None:
    """
    Limpia SOLO stubs generados (generated:true) dentro de una sección.
    Soporta:
      - leaf bundle:  content/<sec>/<slug>/index.md
      - branch bundle: content/<sec>/<slug>/_index.md
      - leaf pages sueltas .md (p.ej. guias/seguridad.md)
    Mantiene cualquier contenido no generado.
    """
    if not section_dir.exists():
        return

    for child in section_dir.iterdir():
        # mantenemos el _index.md de la sección (se puede regenerar con --force)
        if child.is_file() and child.name == "_index.md":
            continue

        if child.is_dir():
            idx_leaf = child / "index.md"
            idx_branch = child / "_index.md"

            if is_generated_file(idx_leaf) or is_generated_file(idx_branch):
                for p in sorted(child.rglob("*"), reverse=True):
                    if p.is_file():
                        p.unlink()
                    else:
                        p.rmdir()
                child.rmdir()
            # si no parece generado, no tocamos
            continue

        # archivos .md sueltos
        if child.is_file() and child.suffix.lower() == ".md":
            if is_generated_file(child):
                child.unlink()


# -------------------------------
# Main
# -------------------------------

def main() -> None:
    ap = argparse.ArgumentParser()
    ap.add_argument("--force", action="store_true", help="Sobrescribe stubs generados")

    ap.add_argument(
        "--clean-modelos",
        action="store_true",
        help="(Legacy) Limpia content/modelos (excepto modelos/_index.md) antes de generar",
    )

    ap.add_argument(
        "--clean-all",
        action="store_true",
        help="Limpia stubs generados (generated:true) en content/modelos, content/marcas y content/guias",
    )

    args = ap.parse_args()

    db = load_db()
    brands = (db.get("brands", {}) or {})

    if args.clean_all:
        safe_clean_section(CONTENT / "modelos")
        safe_clean_section(CONTENT / "marcas")
        safe_clean_section(CONTENT / "guias")
        print("OK: limpieza segura (generated:true) ejecutada.")

    if args.clean_modelos:
        clean_modelos_dir()
        print("OK: limpieza modelos (bruta) ejecutada.")

    # HOME + secciones (branch bundles => _index.md)
    write_file(
        CONTENT / "_index.md",
        fm(title="Inicio", slug="", kind="home", extra=None),
        force=args.force,
    )
    write_file(
        CONTENT / "marcas" / "_index.md",
        fm(title="Marcas", slug="marcas", kind="marcas"),
        force=args.force,
    )
    write_file(
        CONTENT / "modelos" / "_index.md",
        fm(title="Modelos", slug="modelos", kind="modelos"),
        force=args.force,
    )
    write_file(
        CONTENT / "guias" / "_index.md",
        fm(title="Guías", slug="guias", kind="guias"),
        force=args.force,
    )

    # Guías genéricas (leaf pages => .md normal)
    write_file(
        CONTENT / "guias" / "seguridad.md",
        fm(
            title="Seguridad",
            slug="seguridad",
            kind="guia",
            extra={"guideKey": "seguridad"},
        ),
        force=args.force,
    )
    write_file(
        CONTENT / "guias" / "mantenimiento.md",
        fm(
            title="Mantenimiento",
            slug="mantenimiento",
            kind="guia",
            extra={"guideKey": "mantenimiento"},
        ),
        force=args.force,
    )
    write_file(
        CONTENT / "guias" / "compra.md",
        fm(
            title="Cómo elegir recambio",
            slug="compra",
            kind="guia",
            extra={"guideKey": "compra"},
        ),
        force=args.force,
    )

    # Marcas + modelos
    for brand_key, brand in brands.items():
        brand = brand or {}
        brand_name = brand.get("name") or brand_key
        brand_slug = slugify(brand_key)

        # página de marca (branch bundle)
        # CLAVE: NO forzamos type aquí. Hugo usará section = "marcas" -> layouts/marcas/single.html
        write_file(
            CONTENT / "marcas" / brand_slug / "_index.md",
            fm(
                title=brand_name,
                slug=brand_slug,
                kind=None,  # <-- NO type
                extra={"brandKey": brand_key},
            ),
            force=args.force,
        )

        # modelos de esa marca (leaf bundle: content/modelos/<slug>/index.md)
        for m in (brand.get("models", []) or []):
            model_name = (m.get("model") or "").strip()
            model_slug = (m.get("slug") or "").strip() or slugify(f"{brand_key}-{model_name}")
            title = f"{brand_name} {model_name}".strip()

            # CLAVE: NO forzamos type aquí.
            # Hugo usará section = "modelos" -> layouts/modelos/single.html
            write_file(
                CONTENT / "modelos" / model_slug / "index.md",
                fm(
                    title=title,
                    slug=model_slug,
                    kind=None,  # <-- NO type
                    extra={
                        "brandKey": brand_key,
                        "modelSlug": model_slug,
                    },
                ),
                force=args.force,
            )

    print("OK: stubs generados.")


if __name__ == "__main__":
    main()


===============================
ARCHIVO: C:\Users\kikes\OneDrive\Escritorio\Nueva carpeta\recambios-aspirador\tools\sync_ofertas.py
===============================
from __future__ import annotations

from pathlib import Path
import yaml

ROOT = Path(__file__).resolve().parents[1]
CATALOG = ROOT / "data" / "aspiradores.yaml"
OFFERS = ROOT / "data" / "ofertas.yaml"

PLACEHOLDER_URL = "RELLENAR_URL_ALIEXPRESS"
PLACEHOLDER_EST = "RELLENAR_COSTE_ESTIMADO"
PLACEHOLDER_BADGE = "RELLENAR_BADGES"


def load_yaml(path: Path) -> dict:
    if not path.exists():
        return {}
    return yaml.safe_load(path.read_text(encoding="utf-8")) or {}


def dump_yaml(path: Path, data: dict) -> None:
    text = yaml.safe_dump(data, sort_keys=False, allow_unicode=True).strip() + "\n"
    path.write_text(text, encoding="utf-8")


def collect_skus(db: dict) -> set[str]:
    skus: set[str] = set()
    brands = db.get("brands") or {}
    if not isinstance(brands, dict):
        return skus

    for _bk, brand in brands.items():
        brand = brand or {}
        for m in (brand.get("models") or []):
            m = m or {}
            rec = m.get("recambios") or {}
            if not isinstance(rec, dict):
                continue
            for _cat, items in rec.items():
                if not items:
                    continue
                for it in items:
                    it = it or {}
                    sku = it.get("sku")
                    if sku:
                        skus.add(str(sku).strip())
    return skus


def is_placeholder(value: str | None, placeholder: str) -> bool:
    if value is None:
        return True
    v = str(value).strip()
    return v == "" or v == placeholder


def ensure_offer_obj(existing: object | None) -> dict:
    if isinstance(existing, dict):
        return existing
    return {}


def main() -> None:
    catalog = load_yaml(CATALOG)
    want = collect_skus(catalog)

    offers_doc = load_yaml(OFFERS)
    offers = offers_doc.get("offers")
    if not isinstance(offers, dict):
        offers = {}

    added = 0
    updated = 0
    orphaned = 0

    # 1) Añadir / completar estructura (sin pisar valores ya rellenos)
    for sku in sorted(want):
        obj = ensure_offer_obj(offers.get(sku))

        # url
        if is_placeholder(obj.get("url"), PLACEHOLDER_URL):
            obj["url"] = PLACEHOLDER_URL

        # estimated price (opcional; si no lo quieres, puedes borrar estas 2 líneas)
        if is_placeholder(obj.get("estimated_price_range"), PLACEHOLDER_EST):
            obj["estimated_price_range"] = PLACEHOLDER_EST

        # badges
        badges = obj.get("badges")
        if not isinstance(badges, list) or len(badges) == 0:
            obj["badges"] = [PLACEHOLDER_BADGE]
        else:
            # si tiene exactamente el placeholder, lo dejamos
            pass

        # housekeeping
        if obj.get("orphaned") is True:
            obj.pop("orphaned", None)

        if sku not in offers:
            offers[sku] = obj
            added += 1
        else:
            offers[sku] = obj
            updated += 1

    # 2) Marcar huérfanos (no borrar)
    for sku, obj in list(offers.items()):
        if sku not in want:
            obj = ensure_offer_obj(obj)
            if obj.get("orphaned") is not True:
                obj["orphaned"] = True
                offers[sku] = obj
                orphaned += 1

    offers_doc["offers"] = offers
    dump_yaml(OFFERS, offers_doc)

    print(f"OK sync_ofertas.py -> nuevos={added} actualizados={updated} orphaned_marcados={orphaned} total={len(offers)}")
    print(f"Archivo: {OFFERS}")


if __name__ == "__main__":
    main()

